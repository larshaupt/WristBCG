# Sweeps

To execute all experiments, I use Weights and Biases. You can find all sweep configurations in this directory. A configuration can be executed like this:

```
wandb login
wandb sweep --project WristBCG PATH_TO_CONFIG
# Returns SWEEP_ID
wandb agent SWEEP_ID
```

### Self-Supervised Learning
Before executing the sweeps ending with `_finetune.yaml`, you need to execute the corresponding sweep ending with `_pretrain.yaml`.

1. **Download the OxWearables ResNET pretrained model**:
   - Please download the model [here](https://wearables-files.ndph.ox.ac.uk/files/ssl/mtl_best.mdl) from the OxWearables repository, and place it into the `model` directory of your project.

2. **Run the pretrain sweep**:
   - Execute the pretraining sweep first to train the model with self-supervised learning.
   - Once the pretraining sweep is complete, you can then execute the corresponding fine-tuning sweep.

### Replicating Experiments
To replicate the experiments and generate plots, follow these steps:

#### Step 1: Running Weights and Biases (WandB) Experiments

1. **Login to WandB**:
   ```
   wandb login
   ```

2. **Execute the sweep command** to run all the configurations for your experiments:
   ```
   wandb sweep --project WristBCG PATH_TO_CONFIG
   ```

3. **Start the agent** after getting the `SWEEP_ID` from the previous step:
   ```
   wandb agent SWEEP_ID
   ```

4. **Track progress** and results of the sweep on your WandB dashboard. The agent will execute the sweep and automatically run the experiments.

#### Step 2: Generating Plots from the Results

After running the experiments via WandB, use the `make_wandb_plots.py` script to generate comparative plots.

1. **Run the `make_wandb_plots.py` script** with the sweep IDs of the experiments you want to compare:

   ```
   python make_wandb_plots.py --sweep_ids SWEEP_ID_1 SWEEP_ID_2
   ```

2. **Review the generated plots** for performance comparisons, visualizing metrics like accuracy, loss, and other relevant results from your experiments.

#### Step 3: Analyze Results

Use the plots and tables generated by `make_wandb_plots.py` to analyze the performance of different models, hyperparameters, or configurations. You can compare experiments side by side, such as those using supervised learning, self-supervised learning, or postprocessing methods.

## Results
To compare the results you can use `make_wandb_plots.py`. Enter the respective sweep ID for every experiment and generate the plots and tables containing the results.
